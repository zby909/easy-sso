# SSO测试说明

## 测试文件

- `sso-complete-test.mjs` - 完整的SSO功能测试脚本（ES模块格式）

## 运行测试

确保SSO服务正在运行（端口3000），然后执行：

```bash
node test/sso-complete-test.mjs
```

## 测试覆盖范围

✅ **认证功能**

- 发送注册验证码
- 用户注册
- 发送登录验证码
- 用户登录
- Session管理

✅ **OAuth 2.0 + PKCE**

- 授权码生成
- 访问令牌获取
- 令牌刷新
- 令牌注销

✅ **会话管理**

- 登录中心注销
- Cookie持久化
- 签名验证

## 测试结果说明

正常情况下所有步骤都应该返回200/201状态码。

**关于令牌刷新和注销：**

- 第7步刷新令牌后会生成新的refresh_token
- 第8步使用新的refresh_token进行注销
- 这确保了令牌的安全性和一致性

**可能的异常情况：**

- 第1-2步：如果邮箱已注册，会返回400错误，但不影响后续测试
- 开发环境使用模拟验证码"123456"，生产环境需要真实验证码
